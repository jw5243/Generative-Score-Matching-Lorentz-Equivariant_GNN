# Running the graph diffusion model on a toy dataset

You can try a simple version of the code using:
```bash
python toy.py
```

This command should create a dataset conssiting of gaussian particles, train a diffusion model over the dataset, then running the sampling method to generate new observations. Plots are created and stored in the folder ```../plots```

Lorentz and permutation equivariance (not invariance) is established using the equivariant_network.py file, which is based on the LorentzNet architecture in the literature. The score-matching network GSGM.py uses this network to maintain the spacetime coordinate nature of four-momentum inputs. However, while the equivariant_network.py network has been shown (via lorentz_equivariance_test.ipynb) to obey equivariance under the Lorentz group SO(1, 3), the overall score-matching generation process is still not Lorentz equivariant. Looking through the score-matching process, equivariance is not present due to the nature of the noise distribution. Noise is sampled in the network since score-matching is based on gaussian diffusion (Brownian motion). The gaussian distribution is invariant under SO(N) rotations, but a generalization to the Lorentz group SO(1, 3) is most likely needed, almost a type of relativistic diffusion. There are implications to relativistic diffusion compared to normal diffusion, such as causality problems, and most papers on such diffusion choose a preferred reference frame, so manifest Lorentz covariance is lost. There is a paper using score-matching in a rotation (and translation) equivariant manner, which may be used in the Lorentz case, but then the structure of GSGM.py might have to be adjusted past just the noise distribution. 

Applying Lorentz equivariance to jet generation using score-matching is currently an unsolved problem. We are at the point where a solution is not known to exist, although I am confident there is a technique that allows for group equivariance and score-matching generation. If you are an undergraduate working on this project, most others would not get the opportunity to work on such an open-ended problem. Modern physics is all about symmetry, so I hope you thoroughly enjoy tackling this research project.